<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!--
        Analytic Accounts with project
    -->
     <record id="analytic.view_account_analytic_account_form" model="ir.ui.view">
            <field name="name">analytic.analytic.account.form</field>
            <field name="model">account.analytic.account</field>
            <field name="arch" type="xml">
                <form string="Analytic Account">
                    <header>
                        <button name="action_contract_send" string="Send by Email" type="object" class="btn-primary"/>
                        <button name="create_invoices" string="Generate Invoice"
                                type="object" class="btn-primary" attrs="{'invisible': [('state', '=', 'locked')]}"/>
                        <button name="locked_account" string="Lock"
                                type="object" class="btn-primary" attrs="{'invisible': [('state', 'in', ('locked','expires_soon','expired'))]}"/>
                        <button name="unlock_account" string="Unlock"
                                type="object" class="btn-primary" attrs="{'invisible': [('state', '!=', 'locked')]}"/>
                        
                        <field name="state" widget="statusbar" statusbar_visible="new,running,expires_soon,expired,locked"/>
                    </header>
                    <sheet string="Analytic Account">
                        <widget name="web_ribbon" title="Expired" bg_color="bg-danger" attrs="{'invisible': [('state', '!=', 'expired')]}"/>
                        <widget name="web_ribbon" title="Locked" bg_color="bg-danger" attrs="{'invisible': [('state', '!=', 'locked')]}"/>
                        <div class="oe_button_box" name="button_box">
                            <button class="oe_stat_button" type="action" name="%(analytic.account_analytic_line_action)d"
                            icon="fa-usd"  string="Cost/Revenue" widget="statinfo"/>
                            <button name="action_view_invoice"
                            type="object"
                            class="oe_stat_button"
                            icon="fa-pencil-square-o"
                            attrs="{'invisible': [('invoice_count', '=', 0)]}">
                            <field name="invoice_count" widget="statinfo" string="Invoices"/>
                        </button>
                        </div>
                        <widget name="web_ribbon" title="Archived" bg_color="bg-danger" attrs="{'invisible': [('active', '=', True)]}"/>
                        <div class="oe_title">
                            <label for="name" class="oe_edit_only"/>
                            <h1>
                                <field name="name" class="oe_inline" placeholder="e.g. Project XYZ"/>
                            </h1>
                        </div>
                        <div name="project"/>
                        <group name="main">
                            <group>
                                <field name="active" invisible="1"/>
                                <field name="code"/>
                                <field name="partner_id"/>
                                <field name="date_of_next_invoice" />
                                <field name="recuring_period" />
                            </group>
                            <group>
                                <field name="group_id"/>
                                <field name="company_id" options="{'no_create': True}" groups="base.group_multi_company"/>
                                <field name="currency_id" options="{'no_create': True}" groups="base.group_multi_currency"/>
                                <field name="start_contract_date"/>
                                <field name="end_contract_date"/>
                                <field name="remindar_days" attrs="{'invisible': [('state', 'not in', ('expires_soon','expired'))]}"/>
                            </group>
                        </group>
                         <notebook>
                            <page string="Contact Lines">
                                <field name="contact_line">
                                    <tree>
                                        <field name="product_id" force_save="1"/>
                                        <field name="name"/>
                                        <field name="product_uom_qty" string="Ordered Qty"/>
                                        <field name="product_uom" string="Unit of Measure" groups="uom.group_uom"/>
                                        <field name="analytic_tag_ids" widget="many2many_tags" groups="analytic.group_analytic_tags" options="{'color_field': 'color'}" domain="['|', ('company_id', '=', False), ('company_id', '=', parent.company_id)]"/>
                                        <field name="price_unit"/>
                                        <field name="tax_id" widget="many2many_tags"/>
                                        <field name="discount" class="oe_inline"/>
                                        <field name="price_subtotal" widget="monetary" groups="account.group_show_line_subtotals_tax_excluded"/>
                                    </tree>
                                </field>
                                <group name="note_group" col="6">
                                    <group class="oe_subtotal_footer oe_right" colspan="2" name="sale_total">
                                        <field name="amount_untaxed" widget='monetary' options="{'currency_field': 'currency_id'}"/>
                                        <field name="amount_tax" widget='monetary' options="{'currency_field': 'currency_id'}"/>
                                        <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                                            <label for="amount_total" />
                                        </div>
                                        <field name="amount_total" nolabel="1" class="oe_subtotal_footer_separator" widget='monetary' options="{'currency_field': 'currency_id'}"/>
                                    </group>
                                    <div class="oe_clear"/>
                                </group>
                            </page>
                            <page string="Order Line">
                                <field name="order_line_ids">
                                    <tree>
                                        <field name="product_id" force_save="1"/>
                                        <field name="name"/>
                                        <field name="product_uom_qty" string="Ordered Qty"/>
                                        <field name="product_uom" string="Unit of Measure" groups="uom.group_uom"/>
                                        <field name="analytic_tag_ids" widget="many2many_tags" groups="analytic.group_analytic_tags" options="{'color_field': 'color'}" domain="['|', ('company_id', '=', False), ('company_id', '=', parent.company_id)]"/>
                                        <field name="price_unit"/>
                                        <field name="tax_id" widget="many2many_tags"/>
                                        <field name="discount" class="oe_inline"/>
                                        <field name="price_subtotal" widget="monetary" groups="account.group_show_line_subtotals_tax_excluded"/>
                                    </tree>
                                </field>
                                <group name="note_group" col="6">
                                    <group class="oe_subtotal_footer oe_right" colspan="2" name="sale_total">
                                        <field name="amount_line_untaxed" widget='monetary' options="{'currency_field': 'currency_id'}"/>
                                        <field name="amount_line_tax" widget='monetary' options="{'currency_field': 'currency_id'}"/>
                                        <div class="oe_subtotal_footer_separator oe_inline o_td_label">
                                            <label for="amount_line_total" />
                                        </div>
                                        <field name="amount_line_total" nolabel="1" class="oe_subtotal_footer_separator" widget='monetary' options="{'currency_field': 'currency_id'}"/>
                                    </group>
                                    <div class="oe_clear"/>
                                </group>
                            </page>
                            <page string="Other Informatation">
                                <field name="description"/>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

    <record id="account_analytic_account_list_view" model="ir.ui.view">
        <field name="name">account.analytic.account.list.view</field>
        <field name="model">account.analytic.account</field>
        <field name="inherit_id" ref="analytic.view_account_analytic_account_list"/>
        <field name="arch" type="xml">
            <field name="partner_id" position="after">
                <field name="state"/>
            </field>
        </field>
    </record>

     <record id="account_analytic_account_search_view" model="ir.ui.view">
        <field name="name">account.analytic.account.search.view</field>
        <field name="model">account.analytic.account</field>
        <field name="inherit_id" ref="analytic.view_account_analytic_account_search"/>
        <field name="arch" type="xml">
            <field name="partner_id" position="after">
                <filter string="Running" name="running_state" domain="[('state', '=', 'running')]"/>
                <filter string="New" name="new_state" domain="[('state', '=', 'new')]"/>
                <filter string="Expiry Soon" name="expiry_soon_state" domain="[('state', '=', 'expires_soon')]"/>
                <filter string="Expired" name="expired_state" domain="[('state', '=', 'expired')]"/>
                <filter string="Locked" name="lock_state" domain="[('state', '=', 'locked')]"/>
            </field>
        </field>
    </record>

</odoo>
